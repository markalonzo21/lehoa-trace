<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Dashboard</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- web UI -->
  <ng-container *ngIf="(traceList | async).length > 0; else emptyDiv">
    <div class="data-table" *ngIf="!isMobile; else mobile">
      <table mat-table [dataSource]="traceList" class="mat-elevation-z8">
        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef>DATE</th>
          <td mat-cell *matCellDef="let element">
            {{element.date | date: 'MMM d - h:mm a'}}
          </td>
        </ng-container>
        <ng-container matColumnDef="age">
          <th mat-header-cell *matHeaderCellDef>AGE</th>
          <td mat-cell *matCellDef="let element">{{element.age}}</td>
        </ng-container>
        <ng-container matColumnDef="gender">
          <th mat-header-cell *matHeaderCellDef>GENDER</th>
          <td mat-cell *matCellDef="let element">{{element.gender}}</td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

    <!-- mobile UI -->
    <ng-template #mobile>
      <ion-segment
        value="today"
        (ionChange)="segmentChanged($event)"
        mode="ios"
      >
        <ion-segment-button value="today">
          <ion-label>Today</ion-label>
        </ion-segment-button>
        <ion-segment-button value="daily">
          <ion-label>Daily</ion-label>
        </ion-segment-button>
      </ion-segment>

      <ng-container *ngFor="let TRACE of traceList | async">
        <ion-grid fixed>
          <ion-note>{{ TRACE.date | date: 'MMM d' }}</ion-note>
          <ion-row
            class="ion-align-items-center"
            *ngFor="let trace of TRACE.traces"
          >
            <ion-col size="2">
              <div class="time">
                <span>{{ trace.date | date: 'h:mm' }}</span
                ><span>{{ trace.date | date: 'a'}}</span>
              </div>
            </ion-col>
            <ion-col size="10" class="col-data">
              <div class="data">
                <ion-chip color="{{ trace.age < 60 ? 'primary' : 'danger' }}">
                  <ion-icon name="checkmark-circle"></ion-icon>
                  <!-- <ion-icon name="close-circle"></ion-icon> -->
                  <span>{{ trace.age }}</span>
                </ion-chip>
                <ion-chip
                  color="{{ trace.gender  === 'male' ? 'primary' : 'danger' }}"
                >
                  <ion-icon name="male-female"></ion-icon>
                  <span>{{ trace.gender }}</span>
                </ion-chip>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ng-container>
    </ng-template>
  </ng-container>

  <ng-template #emptyDiv>
    <div class="empty-data">
      <div class="img">
        <img src="assets/img/document.png" alt="no data" />
      </div>
      <h2>No Data :(</h2>
    </div>
  </ng-template>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button (click)="startScan()">
      <ion-icon name="qr-code-outline"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
